im = im2double(rgb2gray(imread('landscape-a.jpg')));
%im = im2double(rgb2gray(imread('landscape-b.jpg')));
M = calculateM(im, 5);

figure;
subplot(2,2,1)
imshow(im)
subplot(2,2,2)
imshow(M(:,:,1), []);
subplot(2,2,3)
imshow(M(:,:,2), []);
subplot(2,2,4)
imshow(M(:,:,3), []);

